{"version":3,"sources":["assets/Scripts/UI/UIGame.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/typescript.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/2.4/manual/en/scripting/life-cycle-callbacks.html\n\nimport BundleManager from \"../../Common/Bundle/BundleManager\";\nimport Game from \"../../Common/Game\";\nimport GameModel from \"../Model/GameModel\";\nimport GameConst from \"../Src/GameConst\";\n\nconst { ccclass, property } = cc._decorator;\n\nexport enum GameState {\n    null,\n    game,\n    pause,\n    over,\n}\n@ccclass\nexport default class UIGame extends cc.Component {\n    @property(cc.Camera)\n    camera: cc.Camera = null;\n    @property(cc.Label)\n    score: cc.Label = null;\n    preMap: cc.Node = null;\n    cruMap: cc.Node = null;\n    protected onEnable(): void {\n        this.addEvent();\n        this.initMap();\n        this.initPlayer();\n    }\n    async initPlayer() {\n        try {\n            let player = await Game.ObjectPool.Spawn(\"player\", this.node);\n            player.setPosition(0, 0);\n        } catch (error) {\n            console.log(error);\n        }\n    }\n    async initMap() {\n        let temp = Math.floor(Math.random() * 2 + 1);\n        this.preMap = await Game.ObjectPool.Spawn(\"map\" + temp, this.node);\n        this.cruMap = await Game.ObjectPool.Spawn(\"map\" + temp, this.node);\n        this.preMap.setPosition(0, -GameModel.gameHeigth / 2);\n        this.cruMap.setPosition(this.preMap.width + 200, -GameModel.gameHeigth / 2);\n    }\n    async createOneMap() {\n        let temp = Math.floor(Math.random() * 2 + 1);\n        let nextMap = await Game.ObjectPool.Spawn(\"map\" + temp, this.node);\n        nextMap.setPosition(this.cruMap.x + this.preMap.width + 200, -GameModel.gameHeigth / 2);\n        await this.initCoin(nextMap.x);\n        let oldMap = this.preMap;\n        this.preMap = this.cruMap;\n        this.cruMap = nextMap;\n        Game.ObjectPool.UnSpawn(oldMap);\n    }\n    async initCoin(x: number) {\n        try {\n            for (let i = 0; i < 5; i++) {\n                let coin = await Game.ObjectPool.Spawn(\"Coin\", this.node);\n                coin.setPosition(x + i * (i > 2 ? -100 : 100), (Math.random() > 0.5 ? 10 : 40));\n            }\n        } catch (error) {\n            console.log(error);\n        }\n    }\n    protected onDisable(): void {\n        this.removeEvent();\n    }\n    protected update(dt: number): void {\n        if (GameModel.gameState == GameState.game) {\n            this.camera.node.x += GameModel.moveSpeed * dt;\n            this.node.getChildByName(\"Bg\").x += GameModel.moveSpeed * dt;\n        }\n    }\n    addEvent() {\n        Game.Event.addEventListener(GameConst.UI_GameOver, this.gameOver, this);\n        Game.Event.addEventListener(GameConst.UI_GetCoin, this.UIGetCoin, this);\n        Game.Event.addEventListener(GameConst.UI_CreateMap, this.createOneMap, this);\n        //Game.Event.addEventListener(GameConst.UI_GameStart, this.gameStart, this);\n    }\n    removeEvent() {\n        Game.Event.removeEventListener(GameConst.UI_GameOver, this.gameOver, this);\n        Game.Event.removeEventListener(GameConst.UI_GetCoin, this.UIGetCoin, this);\n        Game.Event.removeEventListener(GameConst.UI_CreateMap, this.createOneMap, this);\n        //Game.Event.removeEventListener(GameConst.UI_GameStart, this.gameStart, this);\n    }\n    UIGetCoin() {\n        this.score.string = GameModel.gameScore.toString();\n    }\n\n    async gameOver() {\n        let over = await Game.ObjectPool.Spawn(\"UIGameOver\", this.camera.node);\n        over.setPosition(0, 0, -1);\n        console.log(over.getPosition());\n        this.node.active = false;\n    }\n}\n"]}